create database bai2_022101082
go;
create table KHOA(
MAKHOA varchar(4) ,
TENKHOA varchar(40),
NGTLAP smalldatetime,
TRGKHOA char(4),
PRIMARY KEY(MAKHOA))
/*
INSERT INTO KHOA VALUES('KHMT','Khoa hoc may tinh','7/6/2005','GV01');
INSERT INTO KHOA VALUES('HTTT','He thong thong tin','7/6/2005','GV02');
INSERT INTO KHOA VALUES('CNPM','Cong nghe phan mem','7/6/2005','GV04');
INSERT INTO KHOA VALUES('MTT','Mang va truyen thong',20/10/2005,'GV03');
--INSERT INTO KHOA VALUES('KTMT','Ky thuat may tinh',20/12/2005,	NULL);*/

go
create table MONHOC(
MAMH varchar(10),
TENMH varchar(40),
TCLT tinyint,
TCTH tinyint,
MAKHOA varchar(4),
PRIMARY KEY(MAMH)
)

/*
INSERT INTO MONHOC VALUES ('THDC','Tin hoc dai cuong',4,1,'KHMT');
INSERT INTO MONHOC VALUES ('CTRR','Cau truc roi rac',5,0,'KHMT');
INSERT INTO MONHOC VALUES ('CSDL','Co so du lieu',3,1,'HTTT');
INSERT INTO MONHOC VALUES ('CTDLGT','Cau truc du lieu va giai thuat',3,1,'KHMT');
INSERT INTO MONHOC VALUES ('PTTKTT','Phan tich thiet ke thuat toan',3,0,'KHMT');
INSERT INTO MONHOC VALUES ('DHMT','Do hoa may tinh',3,1,'KHMT');
INSERT INTO MONHOC VALUES ('KTMT','Kien truc may tinh',3,0,'KTMT');
INSERT INTO MONHOC VALUES ('TKCSDL','Thiet ke co so du lieu',3,1,'HTTT');
INSERT INTO MONHOC VALUES ('PTTKHTTT','Phan tich thiet ke he thong thong tin',4,1,'HTTT');
INSERT INTO MONHOC VALUES ('HDH','He dieu hanh',4,0,'KTMT');
INSERT INTO MONHOC VALUES ('NMCNPM','Nhap mon cong nghe phan mem',3,0,'CNPM');
INSERT INTO MONHOC VALUES ('LTCFW','Lap trinh C for win',3,1,'CNPM');
INSERT INTO MONHOC VALUES ('LTHDT','Lap trinh huong doi tuong',3,1,'CNPM');*/


go
create table DIEUKIEN(
MAMH varchar(10),
MAMH_TRUOC varchar(10),
PRIMARY KEY(MAMH,MAMH_TRUOC)
)
go
create table GIAOVIEN(
MAGV char(4),
HOTEN varchar(40),
HOCVI varchar(10),
HOCPHAM varchar(10),
GIOITINH varchar(3),
NGSINH smalldatetime,
NGVL smalldatetime,
HESO numeric(4,2),
MUCLUONG money,
MAKHOA varchar(4)
PRIMARY KEY(MAGV)
)
go
create table LOP(
MALOP char(3),
TENLOP varchar(40),
TRGLOP char(5),
SISO tinyint,
MAGVCN char(4),
PRIMARY KEY(MALOP)
)
/*
INSERT INTO LOP VALUES('K11','Lop 1 khoa 1','K1108', 11,'GV07');
INSERT INTO LOP VALUES('K12','Lop 2 khoa 1','K1205', 12,'GV09');
INSERT INTO LOP VALUES('K13','Lop 3 khoa 1','K1305', 12,'GV14');
*/


go
create table HOCVIEN(
MAHV char(5) ,
HO varchar(40),
TEN varchar(10),
NGSINH smalldatetime,
GIOITINH varchar(3),
NOISINH varchar(40),
MALOP char(3),
PRIMARY KEY(MAHV))
go
--DROP TABLE GIANGDAY;
create table GIANGDAY(
MALOP char(3),
MAMH varchar(10),
MAGV char(4),
HOCKY tinyint,
NAM smallint,
TUNGAY datetime,
DENNGAY datetime,
PRIMARY KEY(MALOP,MAMH, MAGV))
/*
INSERT INTO GIANGDAY VALUES('K11','THDC','GV07',1,2006,'2/1/2006','12/5/2006');
INSERT INTO GIANGDAY VALUES('K12','THDC','GV06',1,2006,'2/1/2006','12/5/2006');
INSERT INTO GIANGDAY VALUES('K13','THDC','GV15',1,2006,'2/1/2006','12/5/2006');
INSERT INTO GIANGDAY VALUES('K11','CTRR','GV02',1,2006,'9/1/2006','17/5/2006');
INSERT INTO GIANGDAY VALUES('K12','CTRR','GV02',1,2006,'9/1/2006','17/5/2006');
INSERT INTO GIANGDAY VALUES('K13','CTRR','GV08',1,2006,'9/1/2006','17/5/2006');
INSERT INTO GIANGDAY VALUES('K11','CSDL','GV05',2,2006,'1/6/2006','15/7/2006');
INSERT INTO GIANGDAY VALUES('K12','CSDL','GV09',2,2006,'1/6/2006','15/7/2006');
INSERT INTO GIANGDAY VALUES('K13','CTDLGT','GV15',2,2006,'1/6/2006','15/7/2006');
INSERT INTO GIANGDAY VALUES('K13','CSDL','GV05',3,2006,'1/8/2006','15/12/2006');
INSERT INTO GIANGDAY VALUES('K13','DHMT','GV07',3,2006,'1/8/2006','15/12/2006');
INSERT INTO GIANGDAY VALUES('K11','CTDLGT','GV15',3,2006,'1/8/2006','15/12/2006');
INSERT INTO GIANGDAY VALUES('K12','CTDLGT','GV15',3,2006,'1/8/2006','15/12/2006');
INSERT INTO GIANGDAY VALUES('K11','HDH','GV04',1,2007,'2/1/2007','18/2/2007');
INSERT INTO GIANGDAY VALUES('K12','HDH','GV04',1,2007,'2/1/2007','20/3/2007');
INSERT INTO GIANGDAY VALUES('K11','DHMT','GV07',1,2007,'18/2/2007','20/3/2007');*/


go
create table KETQUATHI(
MAHV char(5),
MAMH varchar(10),
LANTHI tinyint,
NGTHI smalldatetime,
DIEM numeric(4,2),
KQUA varchar(10),
PRIMARY KEY(MAHV,MAMH,LANTHI)
)
ALTER TABLE KHOA ADD  FOREIGN KEY(TRGKHOA) REFERENCES GIAOVIEN(MAGV);--
ALTER TABLE MONHOC ADD FOREIGN KEY(MAKHOA) REFERENCES KHOA(MAKHOA);--
ALTER TABLE DIEUKIEN ADD  FOREIGN KEY(MAMH) REFERENCES MONHOC(MAMH);
ALTER TABLE DIEUKIEN ADD  FOREIGN KEY(MAMH_TRUOC) REFERENCES MONHOC(MAMH);
ALTER TABLE GIAOVIEN ADD FOREIGN KEY(MAKHOA) REFERENCES KHOA(MAKHOA);
ALTER TABLE LOP ADD  FOREIGN KEY(TRGLOP) REFERENCES HOCVIEN(MAHV);
ALTER TABLE LOP ADD FOREIGN KEY(MAGVCN) REFERENCES GIAOVIEN(MAGV);
ALTER TABLE HOCVIEN ADD  FOREIGN KEY(MALOP) REFERENCES LOP(MALOP);
ALTER TABLE GIANGDAY ADD  FOREIGN KEY(MALOP) REFERENCES LOP(MALOP);
ALTER TABLE GIANGDAY ADD FOREIGN KEY(MAMH) REFERENCES MONHOC(MAMH);
ALTER TABLE GIANGDAY ADD FOREIGN KEY(MAGV) REFERENCES GIAOVIEN(MAGV);
ALTER TABLE KETQUATHI ADD FOREIGN KEY(MAMH) REFERENCES MONHOC(MAMH);
ALTER TABLE KETQUATHI ADD FOREIGN KEY(MAHV) REFERENCES HOCVIEN(MAHV);